View(data)
str(data)
knitr::opts_chunk$set(
echo = TRUE,
message = FALSE,
warning = FALSE
)
data_raw <- rio::import("https://github.com/rladies/spain_nightingale/raw/master/datos_florence.xlsx")
data <- data_raw[c(-1,-2),]
names(data) <- c("fecha", "ejercito", "muertes_zymotic", "muertes_heridas", "muertes_otras", "muertes_zymotic_anual", "muertes_heridas_anual", "muertes_otras_anual")
data$fecha[data$fecha == "Aug_1855"] <- "Aug 1855"
data$fecha <- as.Date(data$fecha, "%m %Y")
data$ejercito <- as.numeric(data$ejercito)
data$muertes_zymotic <- as.numeric(data$muertes_zymotic)
data$muertes_heridas <- as.numeric(data$muertes_heridas)
data$muertes_otras <- as.numeric(data$muertes_otras)
data$muertes_zymotic_anual <- as.numeric(data$muertes_zymotic_anual)
data$muertes_heridas_anual <- as.numeric(data$muertes_heridas_anual)
data$muertes_otras_anual <- as.numeric(data$muertes_otras_natural)
data_raw <- rio::import("https://github.com/rladies/spain_nightingale/raw/master/datos_florence.xlsx")
data <- data_raw[c(-1,-2),]
names(data) <- c("fecha", "ejercito", "muertes_zymotic", "muertes_heridas", "muertes_otras", "muertes_zymotic_anual", "muertes_heridas_anual", "muertes_otras_anual")
data$fecha[data$fecha == "Aug_1855"] <- "Aug 1855"
data$fecha <- as.Date(data$fecha, "%m %Y")
data$ejercito <- as.numeric(data$ejercito)
data$muertes_zymotic <- as.numeric(data$muertes_zymotic)
data$muertes_heridas <- as.numeric(data$muertes_heridas)
data$muertes_otras <- as.numeric(data$muertes_otras)
data$muertes_zymotic_anual <- as.numeric(data$muertes_zymotic_anual)
data$muertes_heridas_anual <- as.numeric(data$muertes_heridas_anual)
data$muertes_otras_anual <- as.numeric(data$muertes_otras_anual)
# Comprobar que las tres últimas columnas se pueden calcular a partir de los datos mensuales
data %>%
dplyr::mutate(muertes_zymotic_anual_calculada = 12000 * muertes_zymotic / ejercito,
muertes_heridas_anual_calculada = 12000 * muertes_heridas / ejercito,
muertes_otras_anual_calculada = 12000 * muertes_otras / ejercito) %>%
tidyr::gather(muertes_anuales_tipo, muertes_anuales_valor, -fecha, -ejercito,
-muertes_zymotic, -muertes_heridas, -muertes_otras) %>%
ggplot2::ggplot(ggplot2::aes(muertes_anuales_tipo, muertes_anuales_valor)) +
ggplot2::geom_col()
# Comprobar que las tres últimas columnas se pueden calcular a partir de los datos mensuales
data %>%
dplyr::mutate(muertes_zymotic_anual_calculada = 12000 * muertes_zymotic / ejercito,
muertes_heridas_anual_calculada = 12000 * muertes_heridas / ejercito,
muertes_otras_anual_calculada = 12000 * muertes_otras / ejercito) %>%
tidyr::gather(muertes_anuales_tipo, muertes_anuales_valor, -fecha, -ejercito,
-muertes_zymotic, -muertes_heridas, -muertes_otras) %>%
ggplot2::ggplot(ggplot2::aes(muertes_anuales_tipo, muertes_anuales_valor)) +
ggplot2::geom_col() +
ggplot2::theme(axis.text.x = ggplot2::element_text(angle = 45))
# Comprobar que las tres últimas columnas se pueden calcular a partir de los datos mensuales
data %>%
dplyr::mutate(muertes_zymotic_anual_calculada = 12000 * muertes_zymotic / ejercito,
muertes_heridas_anual_calculada = 12000 * muertes_heridas / ejercito,
muertes_otras_anual_calculada = 12000 * muertes_otras / ejercito) %>%
tidyr::gather(muertes_anuales_tipo, muertes_anuales_valor, -fecha, -ejercito,
-muertes_zymotic, -muertes_heridas, -muertes_otras) %>%
ggplot2::ggplot(ggplot2::aes(muertes_anuales_tipo, muertes_anuales_valor)) +
ggplot2::geom_col() +
ggplot2::theme(axis.text.x = ggplot2::element_text(angle = 45, vjust = 1, hjust = 1))
knitr::opts_chunk$set(
echo = TRUE,
message = FALSE,
warning = FALSE
)
library("magrittr")
unlink('florence_2_cache', recursive = TRUE)
View(data)
View(data_raw)
data_raw <- rio::import("https://github.com/rladies/spain_nightingale/raw/master/datos_florence.xlsx")
data <- data_raw[c(-1,-2),]
names(data) <- c("fecha", "ejercito", "muertes_zymotic", "muertes_heridas", "muertes_otras", "muertes_zymotic_anual", "muertes_heridas_anual", "muertes_otras_anual")
data$fecha[data$fecha == "Aug_1855"] <- "Aug 1855"
data$fecha <- lubridate::as_date(data$fecha, "%m %Y")
data$ejercito <- as.numeric(data$ejercito)
data$muertes_zymotic <- as.numeric(data$muertes_zymotic)
data$muertes_heridas <- as.numeric(data$muertes_heridas)
data$muertes_otras <- as.numeric(data$muertes_otras)
data$muertes_zymotic_anual <- as.numeric(data$muertes_zymotic_anual)
data$muertes_heridas_anual <- as.numeric(data$muertes_heridas_anual)
data$muertes_otras_anual <- as.numeric(data$muertes_otras_anual)
View(data)
data <- data_raw[c(-1,-2),]
names(data) <- c("fecha", "ejercito", "muertes_zymotic", "muertes_heridas", "muertes_otras", "muertes_zymotic_anual", "muertes_heridas_anual", "muertes_otras_anual")
data$fecha[data$fecha == "Aug_1855"] <- "Aug 1855"
data$fecha <- lubridate::as_date(data$fecha)
View(data)
data <- data_raw[c(-1,-2),]
names(data) <- c("fecha", "ejercito", "muertes_zymotic", "muertes_heridas", "muertes_otras", "muertes_zymotic_anual", "muertes_heridas_anual", "muertes_otras_anual")
data$fecha[data$fecha == "Aug_1855"] <- "Aug 1855"
View(data)
data$fecha <- lubridate::my(data$fecha)
data$fecha <- lubridate::ymd(data$fecha)
View(data)
data <- data_raw[c(-1,-2),]
names(data) <- c("fecha", "ejercito", "muertes_zymotic", "muertes_heridas", "muertes_otras", "muertes_zymotic_anual", "muertes_heridas_anual", "muertes_otras_anual")
data$fecha[data$fecha == "Aug_1855"] <- "Aug 1855"
data$fecha <- lubridate::ymd(data$fecha)
View(data)
data_raw <- rio::import("https://github.com/rladies/spain_nightingale/raw/master/datos_florence.xlsx")
data <- data_raw[c(-1,-2),]
names(data) <- c("fecha", "ejercito", "muertes_zymotic", "muertes_heridas", "muertes_otras", "muertes_zymotic_anual", "muertes_heridas_anual", "muertes_otras_anual")
data$fecha[data$fecha == "Aug_1855"] <- "Aug 1855"
data$fecha <- lubridate::myd(data$fecha)
data$ejercito <- as.numeric(data$ejercito)
data$muertes_zymotic <- as.numeric(data$muertes_zymotic)
data$muertes_heridas <- as.numeric(data$muertes_heridas)
data$muertes_otras <- as.numeric(data$muertes_otras)
data$muertes_zymotic_anual <- as.numeric(data$muertes_zymotic_anual)
data$muertes_heridas_anual <- as.numeric(data$muertes_heridas_anual)
data$muertes_otras_anual <- as.numeric(data$muertes_otras_anual)
View(data)
data_raw <- rio::import("https://github.com/rladies/spain_nightingale/raw/master/datos_florence.xlsx")
data <- data_raw[c(-1,-2),]
names(data) <- c("fecha", "ejercito", "muertes_zymotic", "muertes_heridas", "muertes_otras", "muertes_zymotic_anual", "muertes_heridas_anual", "muertes_otras_anual")
data$ejercito <- as.numeric(data$ejercito)
data$muertes_zymotic <- as.numeric(data$muertes_zymotic)
data$muertes_heridas <- as.numeric(data$muertes_heridas)
data$muertes_otras <- as.numeric(data$muertes_otras)
data$muertes_zymotic_anual <- as.numeric(data$muertes_zymotic_anual)
data$muertes_heridas_anual <- as.numeric(data$muertes_heridas_anual)
data$muertes_otras_anual <- as.numeric(data$muertes_otras_anual)
data$fecha[data$fecha == "Aug_1855"] <- "Aug 1855"
data %<>%
tidyr::separate(fecha, c(m, y), sep = " ") %>%
dplyr::mutate(fecha = lubridate::make_date(y,m)) %>%
dplyr::select(-m,-y)
data_raw <- rio::import("https://github.com/rladies/spain_nightingale/raw/master/datos_florence.xlsx")
data <- data_raw[c(-1,-2),]
names(data) <- c("fecha", "ejercito", "muertes_zymotic", "muertes_heridas", "muertes_otras", "muertes_zymotic_anual", "muertes_heridas_anual", "muertes_otras_anual")
data$ejercito <- as.numeric(data$ejercito)
data$muertes_zymotic <- as.numeric(data$muertes_zymotic)
data$muertes_heridas <- as.numeric(data$muertes_heridas)
data$muertes_otras <- as.numeric(data$muertes_otras)
data$muertes_zymotic_anual <- as.numeric(data$muertes_zymotic_anual)
data$muertes_heridas_anual <- as.numeric(data$muertes_heridas_anual)
data$muertes_otras_anual <- as.numeric(data$muertes_otras_anual)
data$fecha[data$fecha == "Aug_1855"] <- "Aug 1855"
data %<>%
tidyr::separate(fecha, into = c(m, y), sep = " ") %>%
dplyr::mutate(fecha = lubridate::make_date(y,m)) %>%
dplyr::select(-m,-y)
data_raw <- rio::import("https://github.com/rladies/spain_nightingale/raw/master/datos_florence.xlsx")
data <- data_raw[c(-1,-2),]
names(data) <- c("fecha", "ejercito", "muertes_zymotic", "muertes_heridas", "muertes_otras", "muertes_zymotic_anual", "muertes_heridas_anual", "muertes_otras_anual")
data$ejercito <- as.numeric(data$ejercito)
data$muertes_zymotic <- as.numeric(data$muertes_zymotic)
data$muertes_heridas <- as.numeric(data$muertes_heridas)
data$muertes_otras <- as.numeric(data$muertes_otras)
data$muertes_zymotic_anual <- as.numeric(data$muertes_zymotic_anual)
data$muertes_heridas_anual <- as.numeric(data$muertes_heridas_anual)
data$muertes_otras_anual <- as.numeric(data$muertes_otras_anual)
data$fecha[data$fecha == "Aug_1855"] <- "Aug 1855"
data %<>%
tidyr::separate(fecha, into = c("m", "y"), sep = " ") %>%
dplyr::mutate(fecha = lubridate::make_date(y,m)) %>%
dplyr::select(-m,-y)
View(data)
data_raw <- rio::import("https://github.com/rladies/spain_nightingale/raw/master/datos_florence.xlsx")
data <- data_raw[c(-1,-2),]
names(data) <- c("fecha", "ejercito", "muertes_zymotic", "muertes_heridas", "muertes_otras", "muertes_zymotic_anual", "muertes_heridas_anual", "muertes_otras_anual")
data$ejercito <- as.numeric(data$ejercito)
data$muertes_zymotic <- as.numeric(data$muertes_zymotic)
data$muertes_heridas <- as.numeric(data$muertes_heridas)
data$muertes_otras <- as.numeric(data$muertes_otras)
data$muertes_zymotic_anual <- as.numeric(data$muertes_zymotic_anual)
data$muertes_heridas_anual <- as.numeric(data$muertes_heridas_anual)
data$muertes_otras_anual <- as.numeric(data$muertes_otras_anual)
data$fecha[data$fecha == "Aug_1855"] <- "Aug 1855"
data %<>%
tidyr::separate(fecha, into = c("m", "y"), sep = " ") %>%
dplyr::mutate(fecha = lubridate::make_date(y,m))
View(data)
data_raw <- rio::import("https://github.com/rladies/spain_nightingale/raw/master/datos_florence.xlsx")
data <- data_raw[c(-1,-2),]
names(data) <- c("fecha", "ejercito", "muertes_zymotic", "muertes_heridas", "muertes_otras", "muertes_zymotic_anual", "muertes_heridas_anual", "muertes_otras_anual")
data$ejercito <- as.numeric(data$ejercito)
data$muertes_zymotic <- as.numeric(data$muertes_zymotic)
data$muertes_heridas <- as.numeric(data$muertes_heridas)
data$muertes_otras <- as.numeric(data$muertes_otras)
data$muertes_zymotic_anual <- as.numeric(data$muertes_zymotic_anual)
data$muertes_heridas_anual <- as.numeric(data$muertes_heridas_anual)
data$muertes_otras_anual <- as.numeric(data$muertes_otras_anual)
data$fecha[data$fecha == "Aug_1855"] <- "Aug 1855"
data %<>%
tidyr::separate(fecha, into = c("m", "y"), sep = " ") %>%
dplyr::mutate(y = as.numeric(y),
fecha = lubridate::make_date(y,m))
View(data)
str(data)
data_raw <- rio::import("https://github.com/rladies/spain_nightingale/raw/master/datos_florence.xlsx")
data <- data_raw[c(-1,-2),]
names(data) <- c("fecha", "ejercito", "muertes_zymotic", "muertes_heridas", "muertes_otras", "muertes_zymotic_anual", "muertes_heridas_anual", "muertes_otras_anual")
data$ejercito <- as.numeric(data$ejercito)
data$muertes_zymotic <- as.numeric(data$muertes_zymotic)
data$muertes_heridas <- as.numeric(data$muertes_heridas)
data$muertes_otras <- as.numeric(data$muertes_otras)
data$muertes_zymotic_anual <- as.numeric(data$muertes_zymotic_anual)
data$muertes_heridas_anual <- as.numeric(data$muertes_heridas_anual)
data$muertes_otras_anual <- as.numeric(data$muertes_otras_anual)
data$fecha[data$fecha == "Aug_1855"] <- "Aug 1855"
data$fecha <- as.Date(fecha, "m Y")
data_raw <- rio::import("https://github.com/rladies/spain_nightingale/raw/master/datos_florence.xlsx")
data <- data_raw[c(-1,-2),]
names(data) <- c("fecha", "ejercito", "muertes_zymotic", "muertes_heridas", "muertes_otras", "muertes_zymotic_anual", "muertes_heridas_anual", "muertes_otras_anual")
data$ejercito <- as.numeric(data$ejercito)
data$muertes_zymotic <- as.numeric(data$muertes_zymotic)
data$muertes_heridas <- as.numeric(data$muertes_heridas)
data$muertes_otras <- as.numeric(data$muertes_otras)
data$muertes_zymotic_anual <- as.numeric(data$muertes_zymotic_anual)
data$muertes_heridas_anual <- as.numeric(data$muertes_heridas_anual)
data$muertes_otras_anual <- as.numeric(data$muertes_otras_anual)
data$fecha[data$fecha == "Aug_1855"] <- "Aug 1855"
data$fecha <- as.Date(data$fecha, "m Y")
View(data)
data_raw <- rio::import("https://github.com/rladies/spain_nightingale/raw/master/datos_florence.xlsx")
data <- data_raw[c(-1,-2),]
names(data) <- c("fecha", "ejercito", "muertes_zymotic", "muertes_heridas", "muertes_otras", "muertes_zymotic_anual", "muertes_heridas_anual", "muertes_otras_anual")
data$ejercito <- as.numeric(data$ejercito)
data$muertes_zymotic <- as.numeric(data$muertes_zymotic)
data$muertes_heridas <- as.numeric(data$muertes_heridas)
data$muertes_otras <- as.numeric(data$muertes_otras)
data$muertes_zymotic_anual <- as.numeric(data$muertes_zymotic_anual)
data$muertes_heridas_anual <- as.numeric(data$muertes_heridas_anual)
data$muertes_otras_anual <- as.numeric(data$muertes_otras_anual)
data$fecha[data$fecha == "Aug_1855"] <- "Aug 1855"
data$fecha <- as.Date(fecha, "m Y")
data_raw <- rio::import("https://github.com/rladies/spain_nightingale/raw/master/datos_florence.xlsx")
data <- data_raw[c(-1,-2),]
names(data) <- c("fecha", "ejercito", "muertes_zymotic", "muertes_heridas", "muertes_otras", "muertes_zymotic_anual", "muertes_heridas_anual", "muertes_otras_anual")
data$ejercito <- as.numeric(data$ejercito)
data$muertes_zymotic <- as.numeric(data$muertes_zymotic)
data$muertes_heridas <- as.numeric(data$muertes_heridas)
data$muertes_otras <- as.numeric(data$muertes_otras)
data$muertes_zymotic_anual <- as.numeric(data$muertes_zymotic_anual)
data$muertes_heridas_anual <- as.numeric(data$muertes_heridas_anual)
data$muertes_otras_anual <- as.numeric(data$muertes_otras_anual)
data$fecha[data$fecha == "Aug_1855"] <- "Aug 1855"
data %<>%
tidyr::separate(fecha, into = c("m", "y"), sep = " ") %>%
dplyr::mutate(y = as.numeric(y),
m = lubridate::month(m),
fecha = lubridate::make_date(y,m))
View(data)
data_raw <- rio::import("https://github.com/rladies/spain_nightingale/raw/master/datos_florence.xlsx")
data <- data_raw[c(-1,-2),]
names(data) <- c("fecha", "ejercito", "muertes_zymotic", "muertes_heridas", "muertes_otras", "muertes_zymotic_anual", "muertes_heridas_anual", "muertes_otras_anual")
data$ejercito <- as.numeric(data$ejercito)
data$muertes_zymotic <- as.numeric(data$muertes_zymotic)
data$muertes_heridas <- as.numeric(data$muertes_heridas)
data$muertes_otras <- as.numeric(data$muertes_otras)
data$muertes_zymotic_anual <- as.numeric(data$muertes_zymotic_anual)
data$muertes_heridas_anual <- as.numeric(data$muertes_heridas_anual)
data$muertes_otras_anual <- as.numeric(data$muertes_otras_anual)
data$fecha[data$fecha == "Aug_1855"] <- "Aug 1855"
data %<>%
tidyr::separate(fecha, into = c("m", "y"), sep = " ") %>%
dplyr::mutate(y = as.numeric(y),
m = lubridate::month(m, label = TRUE),
fecha = lubridate::make_date(y,m))
month.abb
data_raw <- rio::import("https://github.com/rladies/spain_nightingale/raw/master/datos_florence.xlsx")
data <- data_raw[c(-1,-2),]
names(data) <- c("fecha", "ejercito", "muertes_zymotic", "muertes_heridas", "muertes_otras", "muertes_zymotic_anual", "muertes_heridas_anual", "muertes_otras_anual")
data$ejercito <- as.numeric(data$ejercito)
data$muertes_zymotic <- as.numeric(data$muertes_zymotic)
data$muertes_heridas <- as.numeric(data$muertes_heridas)
data$muertes_otras <- as.numeric(data$muertes_otras)
data$muertes_zymotic_anual <- as.numeric(data$muertes_zymotic_anual)
data$muertes_heridas_anual <- as.numeric(data$muertes_heridas_anual)
data$muertes_otras_anual <- as.numeric(data$muertes_otras_anual)
data$fecha[data$fecha == "Aug_1855"] <- "Aug 1855"
data %<>%
tidyr::separate(fecha, into = c("m", "y"), sep = " ") %>%
dplyr::mutate(y = as.numeric(y),
m = match(m, month.abb),
fecha = lubridate::make_date(y,m))
View(data)
data_raw <- rio::import("https://github.com/rladies/spain_nightingale/raw/master/datos_florence.xlsx")
data <- data_raw[c(-1,-2),]
names(data) <- c("fecha", "ejercito", "muertes_zymotic", "muertes_heridas", "muertes_otras", "muertes_zymotic_anual", "muertes_heridas_anual", "muertes_otras_anual")
data$ejercito <- as.numeric(data$ejercito)
data$muertes_zymotic <- as.numeric(data$muertes_zymotic)
data$muertes_heridas <- as.numeric(data$muertes_heridas)
data$muertes_otras <- as.numeric(data$muertes_otras)
data$muertes_zymotic_anual <- as.numeric(data$muertes_zymotic_anual)
data$muertes_heridas_anual <- as.numeric(data$muertes_heridas_anual)
data$muertes_otras_anual <- as.numeric(data$muertes_otras_anual)
data$fecha[data$fecha == "Aug_1855"] <- "Aug 1855"
data %<>%
tidyr::separate(fecha, into = c("m", "y"), sep = " ") %>%
dplyr::mutate(y = as.numeric(y),
m = match(m, month.abb),
fecha = lubridate::make_date(y,m)) %>%
dplyr::select(-m, -y)
# Comprobar que las tres últimas columnas se pueden calcular a partir de los datos mensuales
data %>%
dplyr::mutate(muertes_zymotic_anual_calculada = 12000 * muertes_zymotic / ejercito,
muertes_heridas_anual_calculada = 12000 * muertes_heridas / ejercito,
muertes_otras_anual_calculada = 12000 * muertes_otras / ejercito) %>%
tidyr::gather(muertes_anuales_tipo, muertes_anuales_valor, -fecha, -ejercito,
-muertes_zymotic, -muertes_heridas, -muertes_otras) %>%
ggplot2::ggplot(ggplot2::aes(muertes_anuales_tipo, muertes_anuales_valor)) +
ggplot2::geom_col() +
ggplot2::theme(axis.text.x = ggplot2::element_text(angle = 45, vjust = 1, hjust = 1))
View(data)
data$comision <- FALSE
data$comision[data$fecha >= "1855-03-01"]
View(data)
data$comision <- FALSE
data$comision[data$fecha >= "1855-03-01"] <- TRUE
View(data)
data %>%
dplyr::select(fecha, muertes_zymotic_anual, muertes_heridas_anual, muertes_otras_anual) %>%
tidyr::gather(muertes_tipo, muertes_valor, -fecha) %>%
ggplot2::ggplot(x = fecha, y = muertes_valor, col = muertes_tipo) +
ggplot2::geom_line() +
ggplot2::geom_point()
data %>%
dplyr::select(fecha, muertes_zymotic_anual, muertes_heridas_anual, muertes_otras_anual) %>%
tidyr::gather(muertes_tipo, muertes_valor, -fecha) %>%
ggplot2::ggplot(ggplot2::aes(x = fecha, y = muertes_valor, col = muertes_tipo)) +
ggplot2::geom_line() +
ggplot2::geom_point()
data %>%
dplyr::select(fecha, muertes_zymotic_anual, muertes_heridas_anual, muertes_otras_anual) %>%
tidyr::gather(muertes_tipo, muertes_valor, -fecha) %>%
ggplot2::ggplot(ggplot2::aes(x = fecha, y = muertes_valor, col = muertes_tipo)) +
ggplot2::geom_line() +
ggplot2::geom_point() +
ggplot2::scale_y_log10()
data %>%
dplyr::select(fecha, muertes_zymotic_anual, muertes_heridas_anual, muertes_otras_anual) %>%
tidyr::gather(muertes_tipo, muertes_valor, -fecha) %>%
dplyr::mutate(muertes_valor_polar = sqrt(muertes_valor / pi))
data %>%
dplyr::select(fecha, muertes_zymotic_anual, muertes_heridas_anual, muertes_otras_anual) %>%
tidyr::gather(muertes_tipo, muertes_valor, -fecha) %>%
dplyr::mutate(muertes_valor_polar = sqrt(muertes_valor / pi)) %>%
ggplot2::ggplot(ggplot2::aes(x = fecha, y = muertes_valor_polar, col = muertes_tipo)) +
ggplot2::coord_polar()
data %>%
dplyr::select(fecha, muertes_zymotic_anual, muertes_heridas_anual, muertes_otras_anual) %>%
tidyr::gather(muertes_tipo, muertes_valor, -fecha) %>%
dplyr::mutate(muertes_valor_polar = sqrt(muertes_valor / pi)) %>%
ggplot2::ggplot(ggplot2::aes(x = fecha, y = muertes_valor_polar, fill = muertes_tipo)) +
ggplot2::coord_polar()
data %>%
dplyr::select(fecha, muertes_zymotic_anual, muertes_heridas_anual, muertes_otras_anual) %>%
tidyr::gather(muertes_tipo, muertes_valor, -fecha) %>%
dplyr::mutate(muertes_valor_polar = sqrt(muertes_valor / pi)) %>%
ggplot2::ggplot(ggplot2::aes(x = fecha, y = muertes_valor_polar, fill = muertes_tipo)) +
ggplot2::geom_bar() +
ggplot2::coord_polar()
data %>%
dplyr::select(fecha, muertes_zymotic_anual, muertes_heridas_anual, muertes_otras_anual) %>%
tidyr::gather(muertes_tipo, muertes_valor, -fecha) %>%
dplyr::mutate(muertes_valor_polar = sqrt(muertes_valor / pi)) %>%
ggplot2::ggplot(ggplot2::aes(x = fecha, y = muertes_valor_polar, fill = muertes_tipo)) +
ggplot2::geom_col() +
ggplot2::coord_polar()
knitr::opts_chunk$set(
echo = TRUE,
message = FALSE,
warning = FALSE
)
library("magrittr")
data_raw <- rio::import("https://github.com/rladies/spain_nightingale/raw/master/datos_florence.xlsx")
data <- data_raw[c(-1,-2),]
names(data) <- c("fecha", "ejercito", "muertes_zymotic", "muertes_heridas", "muertes_otras", "muertes_zymotic_anual", "muertes_heridas_anual", "muertes_otras_anual")
data$ejercito <- as.numeric(data$ejercito)
data$muertes_zymotic <- as.numeric(data$muertes_zymotic)
data$muertes_heridas <- as.numeric(data$muertes_heridas)
data$muertes_otras <- as.numeric(data$muertes_otras)
data$muertes_zymotic_anual <- as.numeric(data$muertes_zymotic_anual)
data$muertes_heridas_anual <- as.numeric(data$muertes_heridas_anual)
data$muertes_otras_anual <- as.numeric(data$muertes_otras_anual)
data$fecha[data$fecha == "Aug_1855"] <- "Aug 1855"
data %<>%
tidyr::separate(fecha, into = c("m", "y"), sep = " ") %>%
dplyr::mutate(y = as.numeric(y),
m = match(m, month.abb),
fecha = lubridate::make_date(y,m)) %>%
dplyr::select(-m, -y)
# Comprobar que las tres últimas columnas se pueden calcular a partir de los datos mensuales
data %>%
dplyr::mutate(muertes_zymotic_anual_calculada = 12000 * muertes_zymotic / ejercito,
muertes_heridas_anual_calculada = 12000 * muertes_heridas / ejercito,
muertes_otras_anual_calculada = 12000 * muertes_otras / ejercito) %>%
tidyr::gather(muertes_anuales_tipo, muertes_anuales_valor, -fecha, -ejercito,
-muertes_zymotic, -muertes_heridas, -muertes_otras) %>%
ggplot2::ggplot(ggplot2::aes(muertes_anuales_tipo, muertes_anuales_valor)) +
ggplot2::geom_col() +
ggplot2::theme(axis.text.x = ggplot2::element_text(angle = 45, vjust = 1, hjust = 1))
data$comision <- FALSE
data$comision[data$fecha >= "1855-03-01"] <- TRUE
data %>%
dplyr::select(fecha, muertes_zymotic_anual, muertes_heridas_anual, muertes_otras_anual) %>%
tidyr::gather(muertes_tipo, muertes_valor, -fecha) %>%
ggplot2::ggplot(ggplot2::aes(x = fecha, y = muertes_valor, col = muertes_tipo)) +
ggplot2::geom_line() +
ggplot2::geom_point() +
ggplot2::scale_y_log10()
# Representación mediante diagramas "Coxcombs" (usando coordenadas polares)
data %>%
dplyr::select(fecha, muertes_zymotic_anual, muertes_heridas_anual, muertes_otras_anual) %>%
tidyr::gather(muertes_tipo, muertes_valor, -fecha) %>%
dplyr::mutate(muertes_valor_polar = sqrt(muertes_valor / pi)) %>%
ggplot2::ggplot(ggplot2::aes(x = fecha, y = muertes_valor_polar, fill = muertes_tipo)) +
ggplot2::geom_col() +
ggplot2::coord_polar()
data %>%
dplyr::select(fecha, muertes_zymotic_anual, muertes_heridas_anual, muertes_otras_anual)
data %>%
dplyr::select(fecha, muertes_zymotic_anual, muertes_heridas_anual, muertes_otras_anual) %>%
tidyr::gather(muertes_tipo, muertes_valor, -fecha)
data %>%
dplyr::select(fecha, muertes_zymotic_anual, muertes_heridas_anual, muertes_otras_anual)
data %>%
dplyr::select(fecha, muertes_zymotic_anual, muertes_heridas_anual, muertes_otras_anual) %>%
tidyr::gather(muertes_tipo, muertes_valor, -fecha)
data %>%
dplyr::select(fecha, muertes_zymotic_anual, muertes_heridas_anual, muertes_otras_anual) %>%
tidyr::gather(muertes_tipo, muertes_valor, -fecha) %>%
ggplot2::ggplot(ggplot2::aes(x = fecha, y = muertes_valor, col = muertes_tipo))
data %>%
dplyr::select(fecha, muertes_zymotic_anual, muertes_heridas_anual, muertes_otras_anual) %>%
tidyr::gather(muertes_tipo, muertes_valor, -fecha) %>%
ggplot2::ggplot(ggplot2::aes(x = fecha, y = muertes_valor, col = muertes_tipo)) +
ggplot2::geom_line()
data %>%
dplyr::select(fecha, muertes_zymotic_anual, muertes_heridas_anual, muertes_otras_anual) %>%
tidyr::gather(muertes_tipo, muertes_valor, -fecha) %>%
ggplot2::ggplot(ggplot2::aes(x = fecha, y = muertes_valor, col = muertes_tipo)) +
ggplot2::geom_line() +
ggplot2::geom_point()
data %>%
dplyr::select(fecha, muertes_zymotic_anual, muertes_heridas_anual, muertes_otras_anual) %>%
tidyr::gather(muertes_tipo, muertes_valor, -fecha) %>%
ggplot2::ggplot(ggplot2::aes(x = fecha, y = muertes_valor, col = muertes_tipo)) +
ggplot2::geom_line() +
ggplot2::geom_point() +
ggplot2::scale_y_log10()
# Gráfico Q-Q
qqnorm( data$muertes_zymotic_anual ) # la nube de puntos
qqline( data$muertes_zymotic_anual ) # la recta
# Gráfico Q-Q
qqnorm( data$muertes_zymotic_anual ) # la nube de puntos
qqline( data$muertes_zymotic_anual ) # la recta
# Gráfico Q-Q
qqnorm( data$muertes_zymotic_anual ) # la nube de puntos
qqline( data$muertes_zymotic_anual ) # la recta
# Gráfico Q-Q
qqnorm( data$muertes_zymotic_anual ) # la nube de puntos
qqline( data$muertes_zymotic_anual ) # la recta
# Gráfico Q-Q
qqnorm( data$muertes_zymotic_anual ) # la nube de puntos
qqline( data$muertes_zymotic_anual ) # la recta
# Gráfico Q-Q
qqnorm( data$muertes_heridas_anual) # la nube de puntos
qqline( data$muertes_heridas_anual ) # la recta
# Gráfico Q-Q
qqnorm( data$muertes_otras_anual) # la nube de puntos
qqline( data$muertes_otras_anual ) # la recta
shapiro.test ( data$muertes_zymotic_anual)
'''
Realizar el contraste para normalidad. En este contraste la hipótesis nula es la hipótesis de normalidad, esto es, no hay diferencias entre nuestra distribución y una distribución normal con esa media y esa desviación típica. Para contrastar la normalidad usamos el test de Shapiro-Wilk, con la función shapiro.test( )
'''
'''SUPUESTO DE NORMALIDAD: Con el gráfico Q-Q se hace una primera aproximación visual de si hay o no normalidad. Hay que tener en cuenta que este gráfico es meramente descriptivo.
Interpretación: La nube de puntos se sitúa sobre la recta. En un principio, visualmente se aprecia que nuestros datos cumplen el supuesto de normalidad.'''
#SUPUESTO DE NORMALIDAD: Con el gráfico Q-Q se hace una primera aproximación visual de si hay o no normalidad. Hay que tener en cuenta que este gráfico es meramente descriptivo.
#Interpretación: La nube de puntos se sitúa sobre la recta. En un principio, visualmente se aprecia que nuestros datos cumplen el supuesto de normalidad.'''
# Gráfico Q-Q
qqnorm( data$muertes_zymotic_anual ) # la nube de puntos
qqline( data$muertes_zymotic_anual ) # la recta
# Gráfico Q-Q
qqnorm( data$muertes_heridas_anual) # la nube de puntos
qqline( data$muertes_heridas_anual ) # la recta
# Gráfico Q-Q
qqnorm( data$muertes_otras_anual) # la nube de puntos
qqline( data$muertes_otras_anual ) # la recta
# Realizar el contraste para normalidad. En este contraste la hipótesis nula es la hipótesis de normalidad, esto es, no hay diferencias entre nuestra distribución y una distribución normal con esa media y esa desviación típica. Para contrastar la normalidad usamos el test de Shapiro-Wilk, con la función shapiro.test( )
shapiro.test ( data$muertes_zymotic_anual)
shapiro.test ( data$muertes_heridas_anual)
shapiro.test ( data$muertes_otras_anual)
# Gráfico Q-Q
qqnorm( data$muertes_zymotic_anual - data$muertes_heridas_anual ) # la nube de puntos
qqline( data$muertes_zymotic_anual - data$muertes_heridas_anual  ) # la recta
# Gráfico Q-Q
qqnorm( data$muertes_zymotic_anual - data$muertes_heridas_anual ) # la nube de puntos
qqline( data$muertes_zymotic_anual - data$muertes_heridas_anual  ) # la recta
# Gráfico Q-Q
qqnorm( data$muertes_otras_anual - data$muertes_heridas_anual ) # la nube de puntos
qqline( data$muertes_otras_anual - data$muertes_heridas_anual  ) # la recta
# Gráfico Q-Q
qqnorm( data$muertes_zymotic_anual - data$muertes_otras_anual ) # la nube de puntos
qqline( data$muertes_zymotic_anual - data$muertes_otras_anual  ) # la recta
# Gráfico Q-Q
qqnorm( data$muertes_zymotic_anual - data$muertes_heridas_anual ) # la nube de puntos
qqline( data$muertes_zymotic_anual - data$muertes_heridas_anual  ) # la recta
# contraste de normalidad
shapiro.test ( data$muertes_zymotic_anual - data$muertes_heridas_anual  )
# Gráfico Q-Q
qqnorm( data$muertes_zymotic_anual - data$muertes_otras_anual ) # la nube de puntos
qqline( data$muertes_zymotic_anual - data$muertes_otras_anual  ) # la recta
# contraste de normalidad
shapiro.test ( data$muertes_zymotic_anual - data$muertes_otras_anual  )
# Gráfico Q-Q
qqnorm( data$muertes_otras_anual - data$muertes_heridas_anual ) # la nube de puntos
qqline( data$muertes_otras_anual - data$muertes_heridas_anual  ) # la recta
# contraste de normalidad
shapiro.test ( data$muertes_otras_anual - data$muertes_heridas_anual )
